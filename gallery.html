<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TERRA SERVICES | Gallery</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    name="description"
    content="Project gallery for Terra Services — fabrication, engineering, and prototypes."
  />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <!-- HEADER -->
  <header class="site-header">
    <div class="container header-inner">
      <div class="logo">
        <a href="index.html" aria-label="Return to home">
          <img src="terra-services-logo.png" alt="Terra Services logo" class="logo-image" />
        </a>
      </div>
      <nav class="main-nav">
        <a href="index.html#hero">Home</a>
        <a href="index.html#services">Services</a>
        <a href="index.html#about">About</a>
        <a href="gallery.html" aria-current="page">Gallery</a>
        <a href="index.html#contact">Contact</a>
      </nav>
    </div>
  </header>

  <main class="section">
    <div class="container">
      <h1 class="page-title">Gallery</h1>
      <p class="section-intro">
        A selection of fabrication, fixtures, prototypes, and builds. New work gets added regularly.
      </p>

      <div class="gallery-grid" id="galleryGrid">

        <!-- TILE: WELDING (add more <img> inside tile-slides to cycle) -->
        <figure class="gallery-tile" data-cycle="true" data-interval="3500">
          <div class="tile-slides">
            <img src="images/gallery/weld-01.jpg" alt="Custom welded bracket" loading="lazy" decoding="async" />
            <!-- Add more, example:
            <img src="images/gallery/weld-02.jpg" alt="Custom welded bracket — angle view" loading="lazy" decoding="async" />
            -->
          </div>
          <figcaption>Custom welded bracket</figcaption>
        </figure>

        <!-- TILE: FIXTURE (swap image whenever you're ready) -->
        <figure class="gallery-tile" data-cycle="true" data-interval="3500">
          <div class="tile-slides">
            <img src="images/gallery/fixture-01.jpg" alt="Fabrication fixture" loading="lazy" decoding="async" />
            <!-- Add more here to cycle -->
          </div>
          <figcaption>Fabrication fixture</figcaption>
        </figure>

        <!-- TILE: PROTOTYPE -->
        <figure class="gallery-tile" data-cycle="true" data-interval="3500">
          <div class="tile-slides">
            <img src="images/gallery/prototype-01.jpg" alt="Prototype component" loading="lazy" decoding="async" />
          </div>
          <figcaption>Prototype component</figcaption>
        </figure>

        <!-- TILE: SHOP -->
        <figure class="gallery-tile" data-cycle="true" data-interval="3500">
          <div class="tile-slides">
            <img src="images/gallery/shop-01.jpg" alt="Work in progress in the shop" loading="lazy" decoding="async" />
          </div>
          <figcaption>Work in progress</figcaption>
        </figure>

      </div>

      <p class="gallery-note">
        To add photos: upload them to <code>images/gallery/</code>, then duplicate an existing tile or add more
        <code>&lt;img&gt;</code> tags inside a tile to make it cycle.
      </p>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div>
        <strong>TERRA SERVICES</strong>
        <p>From concept to creation.</p>
      </div>
      <div class="footer-note">
        <p>Fabrication ◦ Engineering ◦ Ideas made real</p>
      </div>
    </div>
  </footer>

  <script>
    (function () {
      // ---------- Lightbox ----------
      const grid = document.getElementById("galleryGrid");
      if (!grid) return;

      const overlay = document.createElement("div");
      overlay.className = "lightbox";
      overlay.innerHTML = `
        <div class="lightbox-inner" role="dialog" aria-modal="true">
          <button class="lightbox-close" aria-label="Close">×</button>
          <img class="lightbox-img" alt="">
          <div class="lightbox-caption"></div>
        </div>
      `;
      document.body.appendChild(overlay);

      const imgEl = overlay.querySelector(".lightbox-img");
      const capEl = overlay.querySelector(".lightbox-caption");
      const closeBtn = overlay.querySelector(".lightbox-close");

      function openLightbox(src, alt, caption) {
        imgEl.src = src;
        imgEl.alt = alt || "";
        capEl.textContent = caption || alt || "";
        overlay.classList.add("open");
        document.body.style.overflow = "hidden";
      }

      function closeLightbox() {
        overlay.classList.remove("open");
        imgEl.src = "";
        document.body.style.overflow = "";
      }

      // When clicking a tile, open the currently visible slide
      grid.addEventListener("click", (e) => {
        const tile = e.target.closest(".gallery-tile");
        if (!tile) return;

        const visible = tile.querySelector(".tile-slides img.is-active") || tile.querySelector(".tile-slides img");
        if (!visible) return;

        const caption = tile.querySelector("figcaption")?.textContent || "";
        openLightbox(visible.src, visible.alt, caption);
      });

      overlay.addEventListener("click", (e) => {
        if (e.target === overlay) closeLightbox();
      });

      closeBtn.addEventListener("click", closeLightbox);

      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") closeLightbox();
      });

      // ---------- Per-tile cycling ----------
      const tiles = Array.from(document.querySelectorAll(".gallery-tile[data-cycle='true']"));

      tiles.forEach((tile) => {
        const slidesWrap = tile.querySelector(".tile-slides");
        if (!slidesWrap) return;

        const imgs = Array.from(slidesWrap.querySelectorAll("img"));
        if (imgs.length === 0) return;

        // Make first active
        imgs.forEach((img, i) => img.classList.toggle("is-active", i === 0));

        // If only 1 image, do nothing (prevents weird fade)
        if (imgs.length === 1) return;

        const interval = Math.max(1500, Number(tile.getAttribute("data-interval")) || 3500);
        let idx = 0;

        setInterval(() => {
          imgs[idx].classList.remove("is-active");
          idx = (idx + 1) % imgs.length;
          imgs[idx].classList.add("is-active");
        }, interval);
      });
    })();
  </script>
</body>
</html>
